<%= content_flow_component do |flow| %>

  <% flow.with_header do |header| %>
    <% header.with_title "Situation actuelle de l'occupation", "document-text", "Icône d'illustration" %>
    <% if allowed_to?(:update?, @report) && @report.packing? %>
      <%= header.with_action "Compléter", edit_report_path(@report, "situation_occupation"), icon: "pencil-square", modal: true %>
    <% end %>
  <% end %>

  <%=
  flow.with_section do
    description_list_component(@report) do |list|
      if display_situation_occupation_annee?
        list.with_attribute(:situation_occupation_annee) do
          render_valid_content(:situation_occupation_annee) { @report.situation_occupation_annee }
        end
      end

      if display_situation_nature_occupation?
        list.with_attribute(:situation_nature_occupation) do
          render_valid_content(:situation_nature_occupation) { situation_nature_occupation }
        end
      end

      if display_situation_majoration_rs?
        list.with_attribute(:situation_majoration_rs) do
          render_valid_content(:situation_majoration_rs) { t(@report.situation_majoration_rs.to_s, scope: "enum.boolean") }
        end
      end

      if display_situation_annee_cfe?
        list.with_attribute(:situation_annee_cfe) do
          render_valid_content(:situation_annee_cfe) { @report.situation_annee_cfe }
        end
      end

      if display_situation_vacance_fiscale?
        list.with_attribute(:situation_vacance_fiscale) do
          render_valid_content(:situation_vacance_fiscale) { t(@report.situation_vacance_fiscale.to_s, scope: "enum.boolean") }
        end
      end

      if display_situation_nombre_annees_vacance?
        list.with_attribute(:situation_nombre_annees_vacance) do
          render_valid_content(:situation_nombre_annees_vacance) { @report.situation_nombre_annees_vacance }
        end
      end

      if display_situation_siren_dernier_occupant?
        list.with_attribute(:situation_siren_dernier_occupant) do
          render_valid_content(:situation_siren_dernier_occupant) { helpers.display_siren(@report.situation_siren_dernier_occupant) }
        end
      end

      if display_situation_nom_dernier_occupant?
        list.with_attribute(:situation_nom_dernier_occupant) do
          render_valid_content(:situation_nom_dernier_occupant) { @report.situation_nom_dernier_occupant }
        end
      end

      if display_situation_vlf_cfe?
        list.with_attribute(:situation_vlf_cfe) do
          render_valid_content(:situation_vlf_cfe) { number_with_delimiter(@report.situation_vlf_cfe) }
        end
      end

      if display_situation_taxation_base_minimum?
        list.with_attribute(:situation_taxation_base_minimum) do
          render_valid_content(:situation_taxation_base_minimum) { t(@report.situation_taxation_base_minimum.to_s, scope: "enum.boolean") }
        end
      end
    end
  end
  %>
<% end %>
